# VideoSDK Room Switch Demo

A React application demonstrating seamless participant room switching using [VideoSDK](https://videosdk.live/) React SDK. This demo showcases both normal room switching and Media Relay functionality.



https://github.com/user-attachments/assets/e98c8fd1-c1bc-4058-b84c-cd6a6834a45e



## Features

- **Two-Room Setup**: Room A and Room B with VideoSDK (created automatically)
- **Seamless Room Switching**: Switch between rooms without page reload
- **Media Relay Demonstration**: Relay audio/video from one room to another
- **Real-time Controls**: Mic, camera, and room management controls
- **Host & Participant Modes**: Separate interfaces for hosts and participants

## Project Setup

### Prerequisites

- Node.js 18+
- A VideoSDK account and API token from [videosdk.live](https://app.videosdk.live/)

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd <repository-folder>

# Install dependencies
npm install

# Start the development server
npm run dev
```

### Getting Your VideoSDK Token

1. Sign up at [videosdk.live](https://app.videosdk.live/)
2. Navigate to the API Keys section
3. Generate or copy your API token
4. Paste the token in the app's join screen

## How Room Switching is Implemented

### Normal Room Switching

The application implements room switching using two primary approaches:

#### 1. **MeetingProvider Re-initialization Method** (Primary Implementation)

For participants, the app uses React's key prop to force re-initialization of the `MeetingProvider` when switching rooms:

```typescript
// In ParticipantMeetingView.tsx
<MeetingProvider
    key={meetingId} // Force re-initialization when meetingId changes
    config={{
        meetingId: meetingId,
        micEnabled: false,
        webcamEnabled: false,
        name: participantName,
    }}
    token={token}
>
```

**Switching Process:**
1. User selects target room from dropdown
2. Current meeting is left using `leave()`
3. Parent component updates `meetingId` state
4. `MeetingProvider` re-initializes with new `meetingId` (via key prop)
5. New meeting is automatically joined

**Key Benefits:**
- Clean state management
- No page reload required
- Audio/video streams are re-established in new room
- Participant state is preserved
- Minimal latency between rooms (typically 500-1000ms)

#### 2. **VideoSDK's switchTo() Method** (Alternative for Hosts)

For hosts, the app can use VideoSDK's built-in `switchTo()` method:

```typescript
import { useMeeting } from "@videosdk.live/react-sdk";

const { switchTo } = useMeeting();

// Switch to another room seamlessly
switchTo({
  meetingId: targetRoomId,
  token: authToken,
});
```

**Note:** The current implementation primarily uses the MeetingProvider re-initialization method for consistency across both host and participant modes.

### Room Setup

- **Room A** and **Room B** are automatically created when a host joins
- Each room has a unique `meetingId` generated by VideoSDK
- Rooms are managed through the host interface

## Media Relay Usage

Media Relay allows broadcast your audio/video to another room **without leaving your current room**. This enables participants to be visible and audible in multiple rooms simultaneously.

### Use Cases

- **Multi-room broadcasting**: Host appears in multiple rooms simultaneously
- **Cross-room collaboration**: Real-time interaction across different meeting spaces
- **Content Distribution**: Share content from one room to another without switching

### Implementation

The Media Relay feature is implemented using a background `MeetingProvider` instance that joins the target room:

```typescript
// MediaRelay Component Structure
<MeetingProvider
    key={`relay-${targetMeetingId}`}
    config={{
        meetingId: targetMeetingId,  // Target room
        micEnabled: false,
        webcamEnabled: false,
        name: `${participantName} (Relay)`,
    }}
    token={token}
>
    <MediaRelayInner
        sourceMeetingId={currentMeetingId}
        targetMeetingId={targetMeetingId}
        isActive={isActive}
    />
</MeetingProvider>
```

**How It Works:**

1. **Activation**: When Media Relay is toggled ON:
   - A background `MeetingProvider` instance is created
   - It joins the target room with a special name (e.g., "Participant (Relay)")
   - The component attempts to use VideoSDK's `requestMediaRelay()` API if available

2. **Media Streaming**: 
   - The participant's audio/video from the source room is relayed to the target room
   - The participant remains active in the source room
   - Participants in the target room see/hear the relayed media

3. **Deactivation**: When Media Relay is toggled OFF:
   - The background meeting instance leaves the target room
   - Media relay connection is closed
   - Participant remains only in the source room

**UI Integration:**

- Media Relay button appears in `MeetingControls` when multiple rooms are available
- Button shows active state when relay is running
- Participants can toggle relay on/off without leaving their current room

**Note**: Full Media Relay functionality requires VideoSDK's advanced SDK features or ILS (Interactive Live Streaming) mode. The current implementation provides the framework and attempts to use VideoSDK's native API when available. In production, you may need to:
- Use VideoSDK's ILS mode
- Implement a custom media relay solution using WebRTC
- Use VideoSDK's server-side relay capabilities

## Tech Stack

- **React 18** - UI Framework
- **TypeScript** - Type Safety
- **VideoSDK React SDK** - Video Conferencing
- **Tailwind CSS** - Styling
- **Shadcn/UI** - Component Library
- **Vite** - Build Tool
- **React Router** - Navigation

## Resources

- [VideoSDK Documentation](https://docs.videosdk.live/react/)
- [VideoSDK React SDK](https://www.npmjs.com/package/@videosdk.live/react-sdk)
- [Switch Live Stream Guide](https://docs.videosdk.live/react/guide/interactive-live-streaming/switch-live-stream)
- [Media Relay Documentation](https://docs.videosdk.live/react/guide/interactive-live-streaming/relay-media)
